{"version":3,"file":"launchevent.js","mappings":"YAcA,SAASA,EAAgBC,GACrBC,QAAQC,KAAK,mBACb,IAAMC,EAAQH,EAAYI,aAE1B,GAAIJ,EAAYK,SAAWC,OAAOC,kBAAkBC,aAAgCC,IAAtBT,EAAYU,MAEnE,CACH,IAAMC,EAAU,0BAGhB,OAFAV,QAAQW,MAAMD,QACdR,EAAMU,UAAU,CAAEC,YAAY,EAAOC,aAAcJ,GAEvD,EAYJ,SAAoBK,GAEhB,GADAf,QAAQC,KAAK,cACD,MAARc,GAAwB,IAARA,EAChB,OAAO,EAIX,IADA,IAAMC,EAAe,CAAC,OAAQ,UAAW,WAAY,cAC5CC,EAAQ,EAAGA,EAAQD,EAAaE,OAAQD,IAAS,CACtD,IAAME,EAAOH,EAAaC,GAAOG,OAEjC,GADcC,OAAOF,EAAM,KACjBG,KAAKP,GACX,OAAO,CAEf,CAEA,OAAO,CACX,CA1BoBQ,CARLxB,EAAYU,OAcnBP,EAAMU,UAAU,CAAEC,YAAY,IAJ9BR,OAAOmB,QAAQC,QAAQC,KAAKC,oBACxB,CAAExB,aAAcD,GAChB0B,EAIZ,CAoBA,SAASA,EAAuB7B,GAC5BC,QAAQC,KAAK,0BACb,IAAMC,EAAQH,EAAYI,aAC1B,GAAIJ,EAAYU,MAAMS,OAAS,EAAG,CAC9B,IAAK,IAAIW,EAAI,EAAGA,EAAI9B,EAAYU,MAAMS,OAAQW,IAC1C,GAAqC,GAAjC9B,EAAYU,MAAMoB,GAAGC,SAErB,YADA5B,EAAMU,UAAU,CAAEC,YAAY,IAKtCX,EAAMU,UAAU,CACZC,YAAY,EACZC,aAAc,wHAIdiB,qBAAsB,gQAE9B,MACI7B,EAAMU,UAAU,CACZC,YAAY,EACZC,aAAc,yDAIdiB,qBAAsB,iMAGlC,CAGA1B,OAAO2B,QAAQC,UAAU,uBAlFzB,SAA8B/B,GAC1BF,QAAQC,KAAK,wBACbI,OAAOmB,QAAQC,QAAQC,KAAKX,KAAKmB,SAC7B,OACA,CAAE/B,aAAcD,GAChBJ,EAER,GA4EAE,QAAQC,KAAK,iB","sources":["webpack://office-addin-taskpane-js/./src/launchevent/launchevent.js"],"sourcesContent":["/*\r\n* Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT license.\r\n* See LICENSE in the project root for license information.\r\n*/\r\n\r\nfunction onMessageSendHandler(event) {\r\n    console.info(\"onMessageSendHandler\");\r\n    Office.context.mailbox.item.body.getAsync(\r\n        \"text\",\r\n        { asyncContext: event },\r\n        getBodyCallback\r\n    );\r\n}\r\n\r\nfunction getBodyCallback(asyncResult) {\r\n    console.info(\"getBodyCallback\");\r\n    const event = asyncResult.asyncContext;\r\n    let body = \"\";\r\n    if (asyncResult.status !== Office.AsyncResultStatus.Failed && asyncResult.value !== undefined) {\r\n        body = asyncResult.value;\r\n    } else {\r\n        const message = \"Failed to get body text\";\r\n        console.error(message);\r\n        event.completed({ allowEvent: false, errorMessage: message });\r\n        return;\r\n    }\r\n\r\n    const matches = hasMatches(body);\r\n    if (matches) {\r\n        Office.context.mailbox.item.getAttachmentsAsync(\r\n            { asyncContext: event },\r\n            getAttachmentsCallback);\r\n    } else {\r\n        event.completed({ allowEvent: true });\r\n    }\r\n}\r\n\r\nfunction hasMatches(body) {\r\n    console.info(\"hasMatches\");\r\n    if (body == null || body == \"\") {\r\n        return false;\r\n    }\r\n\r\n    const arrayOfTerms = [\"send\", \"picture\", \"document\", \"attachment\"];\r\n    for (let index = 0; index < arrayOfTerms.length; index++) {\r\n        const term = arrayOfTerms[index].trim();\r\n        const regex = RegExp(term, 'i');\r\n        if (regex.test(body)) {\r\n            return true;\r\n        }\r\n    }\r\n\r\n    return false;\r\n}\r\n\r\nfunction getAttachmentsCallback(asyncResult) {\r\n    console.info(\"getAttachmentsCallback\");\r\n    const event = asyncResult.asyncContext;\r\n    if (asyncResult.value.length > 0) {\r\n        for (let i = 0; i < asyncResult.value.length; i++) {\r\n            if (asyncResult.value[i].isInline == false) {\r\n                event.completed({ allowEvent: true });\r\n                return;\r\n            }\r\n        }\r\n\r\n        event.completed({\r\n            allowEvent: false,\r\n            errorMessage: \"Looks like the body of your message includes an image or an inline file. Attach a copy to the message before sending.\",\r\n            // TIP: In addition to the formatted message, it's recommended to also set a\r\n            // plain text message in the errorMessage property for compatibility on\r\n            // older versions of Outlook clients.\r\n            errorMessageMarkdown: \"Looks like the body of your message includes an image or an inline file. Attach a copy to the message before sending.\\n\\n**Tip**: For guidance on how to attach a file, see [Attach files in Outlook](https://www.contoso.com/help/attach-files-in-outlook).\"\r\n        });\r\n    } else {\r\n        event.completed({\r\n            allowEvent: false,\r\n            errorMessage: \"Looks like you're forgetting to include an attachment.\",\r\n            // TIP: In addition to the formatted message, it's recommended to also set a\r\n            // plain text message in the errorMessage property for compatibility on\r\n            // older versions of Outlook clients.\r\n            errorMessageMarkdown: \"Looks like you're forgetting to include an attachment.\\n\\n**Tip**: For guidance on how to attach a file, see [Attach files in Outlook](https://www.contoso.com/help/attach-files-in-outlook).\"\r\n        });\r\n    }\r\n}\r\n\r\n// IMPORTANT: To ensure your add-in is supported in Outlook, remember to map the event handler name specified in the manifest to its JavaScript counterpart.\r\nOffice.actions.associate(\"onMessageSendHandler\", onMessageSendHandler);\r\nconsole.info(\"launchevent.js\");    \r\n"],"names":["getBodyCallback","asyncResult","console","info","event","asyncContext","status","Office","AsyncResultStatus","Failed","undefined","value","message","error","completed","allowEvent","errorMessage","body","arrayOfTerms","index","length","term","trim","RegExp","test","hasMatches","context","mailbox","item","getAttachmentsAsync","getAttachmentsCallback","i","isInline","errorMessageMarkdown","actions","associate","getAsync"],"ignoreList":[],"sourceRoot":""}