{"version":3,"file":"launchevent.js","mappings":"YAaA,SAASA,EAAgBC,GACrB,IAAMC,EAAQD,EAAYE,aAE1B,GAAIF,EAAYG,SAAWC,OAAOC,kBAAkBC,aAAgCC,IAAtBP,EAAYQ,MAEnE,CACH,IAAMC,EAAU,0BAGhB,OAFAC,QAAQC,MAAMF,QACdR,EAAMW,UAAU,CAAEC,YAAY,EAAOC,aAAcL,GAEvD,EAYJ,SAAoBM,GAChB,GAAY,MAARA,GAAwB,IAARA,EAChB,OAAO,EAIX,IADA,IAAMC,EAAe,CAAC,OAAQ,UAAW,WAAY,cAC5CC,EAAQ,EAAGA,EAAQD,EAAaE,OAAQD,IAAS,CACtD,IAAME,EAAOH,EAAaC,GAAOG,OAEjC,GADcC,OAAOF,EAAM,KACjBG,KAAKP,GACX,OAAO,CAEf,CAEA,OAAO,CACX,CAzBoBQ,CARLvB,EAAYQ,OAcnBP,EAAMW,UAAU,CAAEC,YAAY,IAJ9BT,OAAOoB,QAAQC,QAAQC,KAAKC,oBACxB,CAAEzB,aAAcD,GAChB2B,EAIZ,CAmBA,SAASA,EAAuB5B,GAC5B,IAAMC,EAAQD,EAAYE,aAC1B,GAAIF,EAAYQ,MAAMU,OAAS,EAAG,CAC9B,IAAK,IAAIW,EAAI,EAAGA,EAAI7B,EAAYQ,MAAMU,OAAQW,IAC1C,GAAqC,GAAjC7B,EAAYQ,MAAMqB,GAAGC,SAErB,YADA7B,EAAMW,UAAU,CAAEC,YAAY,IAKtCZ,EAAMW,UAAU,CACZC,YAAY,EACZC,aAAc,wHAIdiB,qBAAsB,gQAE9B,MACI9B,EAAMW,UAAU,CACZC,YAAY,EACZC,aAAc,yDAIdiB,qBAAsB,iMAGlC,CAGA3B,OAAO4B,QAAQC,UAAU,uBA9EzB,SAA8BhC,GAC1BG,OAAOoB,QAAQC,QAAQC,KAAKX,KAAKmB,SAC7B,OACA,CAAEhC,aAAcD,GAChBF,EAER,E","sources":["webpack://office-addin-taskpane-js/./src/launchevent/launchevent.js"],"sourcesContent":["/*\r\n* Copyright (c) Microsoft Corporation. All rights reserved. Licensed under the MIT license.\r\n* See LICENSE in the project root for license information.\r\n*/\r\n\r\nfunction onMessageSendHandler(event) {\r\n    Office.context.mailbox.item.body.getAsync(\r\n        \"text\",\r\n        { asyncContext: event },\r\n        getBodyCallback\r\n    );\r\n}\r\n\r\nfunction getBodyCallback(asyncResult) {\r\n    const event = asyncResult.asyncContext;\r\n    let body = \"\";\r\n    if (asyncResult.status !== Office.AsyncResultStatus.Failed && asyncResult.value !== undefined) {\r\n        body = asyncResult.value;\r\n    } else {\r\n        const message = \"Failed to get body text\";\r\n        console.error(message);\r\n        event.completed({ allowEvent: false, errorMessage: message });\r\n        return;\r\n    }\r\n\r\n    const matches = hasMatches(body);\r\n    if (matches) {\r\n        Office.context.mailbox.item.getAttachmentsAsync(\r\n            { asyncContext: event },\r\n            getAttachmentsCallback);\r\n    } else {\r\n        event.completed({ allowEvent: true });\r\n    }\r\n}\r\n\r\nfunction hasMatches(body) {\r\n    if (body == null || body == \"\") {\r\n        return false;\r\n    }\r\n\r\n    const arrayOfTerms = [\"send\", \"picture\", \"document\", \"attachment\"];\r\n    for (let index = 0; index < arrayOfTerms.length; index++) {\r\n        const term = arrayOfTerms[index].trim();\r\n        const regex = RegExp(term, 'i');\r\n        if (regex.test(body)) {\r\n            return true;\r\n        }\r\n    }\r\n\r\n    return false;\r\n}\r\n\r\nfunction getAttachmentsCallback(asyncResult) {\r\n    const event = asyncResult.asyncContext;\r\n    if (asyncResult.value.length > 0) {\r\n        for (let i = 0; i < asyncResult.value.length; i++) {\r\n            if (asyncResult.value[i].isInline == false) {\r\n                event.completed({ allowEvent: true });\r\n                return;\r\n            }\r\n        }\r\n\r\n        event.completed({\r\n            allowEvent: false,\r\n            errorMessage: \"Looks like the body of your message includes an image or an inline file. Attach a copy to the message before sending.\",\r\n            // TIP: In addition to the formatted message, it's recommended to also set a\r\n            // plain text message in the errorMessage property for compatibility on\r\n            // older versions of Outlook clients.\r\n            errorMessageMarkdown: \"Looks like the body of your message includes an image or an inline file. Attach a copy to the message before sending.\\n\\n**Tip**: For guidance on how to attach a file, see [Attach files in Outlook](https://www.contoso.com/help/attach-files-in-outlook).\"\r\n        });\r\n    } else {\r\n        event.completed({\r\n            allowEvent: false,\r\n            errorMessage: \"Looks like you're forgetting to include an attachment.\",\r\n            // TIP: In addition to the formatted message, it's recommended to also set a\r\n            // plain text message in the errorMessage property for compatibility on\r\n            // older versions of Outlook clients.\r\n            errorMessageMarkdown: \"Looks like you're forgetting to include an attachment.\\n\\n**Tip**: For guidance on how to attach a file, see [Attach files in Outlook](https://www.contoso.com/help/attach-files-in-outlook).\"\r\n        });\r\n    }\r\n}\r\n\r\n// IMPORTANT: To ensure your add-in is supported in Outlook, remember to map the event handler name specified in the manifest to its JavaScript counterpart.\r\nOffice.actions.associate(\"onMessageSendHandler\", onMessageSendHandler);\r\n"],"names":["getBodyCallback","asyncResult","event","asyncContext","status","Office","AsyncResultStatus","Failed","undefined","value","message","console","error","completed","allowEvent","errorMessage","body","arrayOfTerms","index","length","term","trim","RegExp","test","hasMatches","context","mailbox","item","getAttachmentsAsync","getAttachmentsCallback","i","isInline","errorMessageMarkdown","actions","associate","getAsync"],"ignoreList":[],"sourceRoot":""}