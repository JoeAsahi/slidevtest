function onMessageSendHandler(e){Office.context.mailbox.item.body.getAsync("text",{asyncContext:e},getBodyCallback)}function getBodyCallback(e){const t=e.asyncContext;let o="";if(e.status===Office.AsyncResultStatus.Failed||void 0===e.value){const e="Failed to get body text";return console.error(e),void t.completed({allowEvent:!1,errorMessage:e})}o=e.value,hasMatches(o)?Office.context.mailbox.item.getAttachmentsAsync({asyncContext:t},getAttachmentsCallback):t.completed({allowEvent:!0})}function hasMatches(e){if(null==e||""==e)return!1;const t=["send","picture","document","attachment"];for(let o=0;o<t.length;o++){const n=t[o].trim();if(RegExp(n,"i").test(e))return!0}return!1}function getAttachmentsCallback(e){const t=e.asyncContext;if(e.value.length>0){for(let o=0;o<e.value.length;o++)if(0==e.value[o].isInline)return void t.completed({allowEvent:!0});t.completed({allowEvent:!1,errorMessage:"Looks like the body of your message includes an image or an inline file. Attach a copy to the message before sending.",errorMessageMarkdown:"Looks like the body of your message includes an image or an inline file. Attach a copy to the message before sending.\n\n**Tip**: For guidance on how to attach a file, see [Attach files in Outlook](https://www.contoso.com/help/attach-files-in-outlook)."})}else t.completed({allowEvent:!1,errorMessage:"Looks like you're forgetting to include an attachment.",errorMessageMarkdown:"Looks like you're forgetting to include an attachment.\n\n**Tip**: For guidance on how to attach a file, see [Attach files in Outlook](https://www.contoso.com/help/attach-files-in-outlook)."})}Office.actions.associate("onMessageSendHandler",onMessageSendHandler);