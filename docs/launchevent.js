!function(){function e(e){console.info("getBodyCallback");var t=e.asyncContext;if(e.status===Office.AsyncResultStatus.Failed||void 0===e.value){var n="Failed to get body text";return console.error(n),void t.completed({allowEvent:!1,errorMessage:n})}!function(e){if(console.info("hasMatches"),null==e||""==e)return!1;for(var o=["send","picture","document","attachment"],t=0;t<o.length;t++){var n=o[t].trim();if(RegExp(n,"i").test(e))return!0}return!1}(e.value)?t.completed({allowEvent:!0}):Office.context.mailbox.item.getAttachmentsAsync({asyncContext:t},o)}function o(e){console.info("getAttachmentsCallback");var o=e.asyncContext;if(e.value.length>0){for(var t=0;t<e.value.length;t++)if(0==e.value[t].isInline)return void o.completed({allowEvent:!0});o.completed({allowEvent:!1,errorMessage:"Looks like the body of your message includes an image or an inline file. Attach a copy to the message before sending.",errorMessageMarkdown:"Looks like the body of your message includes an image or an inline file. Attach a copy to the message before sending.\n\n**Tip**: For guidance on how to attach a file, see [Attach files in Outlook](https://www.contoso.com/help/attach-files-in-outlook)."})}else o.completed({allowEvent:!1,errorMessage:"Looks like you're forgetting to include an attachment.",errorMessageMarkdown:"Looks like you're forgetting to include an attachment.\n\n**Tip**: For guidance on how to attach a file, see [Attach files in Outlook](https://www.contoso.com/help/attach-files-in-outlook)."})}Office.actions.associate("onMessageSendHandler",function(o){console.info("onMessageSendHandler"),Office.context.mailbox.item.body.getAsync("text",{asyncContext:o},e)}),console.info("launchevent.js")}();
//# sourceMappingURL=launchevent.js.map